---
title: EventLoop
date: 2020-10-12 16:27:16
permalink: /pages/b12f03/
categories:
  - JavaScript进阶
  - 执行机制
tags:
  -
---

## 单线程

作为浏览器脚本语言。`JavaScript`的用途是与用户交互，操作DOM。这决定了`JavaScript`只能是单线程的。否则会带来复杂的同步问题

假定`JavaScript`拥有两个线程。一个在dom中添加了内容。另外一个删除了这个节点。这时改以哪个线程为准？

`HTML5`提出了`web worker`，允许创建多个线程。但是完全受主线程控制。而且不能操作dom。这没能改变`JavaScript`单线程的本质

## 同步和异步

单线程意味着所有任务需要排队。前一个任务正在进行中时。后面的人物都要等着。直到任务结束。才会执行下一个任务

所有的任务分为两种：

- 同步任务
- 异步任务

## 执行机制

1. 执行最早的`宏任务`
2. 执行所有`微任务`
   - 如果又出现新的`微任务`，出队并执行最早的微任务
3. 执行渲染。如果有
4. 如果`宏任务`为空。则休眠直到出现`宏任务`
