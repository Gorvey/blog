---
title: 变量对象
date: 2020-10-10 10:25:28
permalink: /pages/71c1ee/
categories:
  - JavaScript进阶
  - 作用域和闭包
tags:
  -
---
## 前言

在[执行上下文栈](/pages/990711/)中讲到。创建一个上下文后。拥有3个重要属性。分别是

- 变量对象
- 作用域链
- this

## 变量对象(Variable Object,VO)

变量对象中包含了当前执行环境所有的变量和函数。另外这些是在后台中。无法使用代码访问

全局上下文和函数上下文稍有不同。这里分开来聊聊

### 全局上下文

> 有且只有一个。在浏览器环境是window对象

### 函数上下文

进入函数中。函数上下文的变量对象会变成`活动对象(Active Object,AO)`，变成活动对象前。其内部属性无法访问

## 上下文的执行过程

### 进入执行上下文

此时还没有执行代码

1. 创建`arguments`对象，初始化形参
2. 函数声明
   每发现一个函数，就在`VO`中创建一个属性。用于引用函数，如果存在。就覆盖这个属性
3. 变量声明
   每发现一个变量，就在`VO`中创建一个属性。并初始化为`undefined`。如果声明存在。则不进行处理

### 执行代码

添加或修改`函数`或`变量`属性

## 总结

1. `变量对象`包含了当前作用域下的所有变量和函数
2. 代码执行过程分为`进入阶段`和`执行阶段`
   1. 在`进入阶段`。会初始化声明的`变量`和`函数`。这就是`变量提升`
   2. 在`执行阶段`。会修改或添加`变量对象`中的属性
3. 全局上下文中的变量对象就是`全局对象`
